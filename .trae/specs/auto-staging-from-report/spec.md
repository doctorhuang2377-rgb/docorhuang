# 报告自动分期功能规格说明书

## 为什么需要
用户目前只能通过手动点击 T/N/M 选项来进行分期，如果用户手头有现成的病理报告或影像学报告，手动查找并对应每一项比较繁琐且容易出错。通过输入报告文本，自动提取关键信息并生成分期，可以极大提高效率和用户体验。

## 变更内容
在应用中增加一个“智能分析”或“导入报告”的功能区域，允许用户粘贴文本，系统自动解析并选中对应的 T/N/M 选项。

### 功能列表
1.  **报告输入区**：
    -   提供一个多行文本框 (Textarea) 供用户粘贴报告。
    -   提供“分析报告”按钮。
    -   提供“清空”按钮。
2.  **智能解析引擎 (规则驱动)**：
    -   **显式分期提取**：识别如 "T1a", "N2", "M0" 等标准术语。
    -   **关键词匹配**：识别如 "7cm", "胸膜侵犯", "脑转移" 等关键词，并映射到对应的 T/N/M 选项。
    -   **优先级逻辑**：当存在多个匹配项时，取分期较重者（或显示冲突供用户选择，初期版本取最重）。
3.  **结果反馈与联动**：
    -   解析成功后，自动在主界面的 T/N/M 选项卡中选中对应项。
    -   高亮显示报告中被识别的关键词（可选，二期实现）。
    -   显示解析结果摘要（例如：“识别到：T2a (3.5cm), N0, M0”）。

## 影响范围
-   **UI 布局**：`index.html` 需要增加输入区域（可能通过模态框或折叠面板）。
-   **核心逻辑**：`app.js` 需要增加解析函数。
-   **数据结构**：`data.js` 可能需要增强，为每个选项增加 `keywords` 字段以便匹配。

## 新增需求

### 需求 1：文本解析
系统必须能从非结构化文本中提取 TNM 信息。
#### 场景：标准报告
-   **当** 用户输入 "右肺上叶恶性肿瘤，大小约 3.5cm (T2a)，无淋巴结转移 (N0)，无远处转移"
-   **则** 系统自动选中 T2a, N0, M0，并显示分期结果。

#### 场景：关键词匹配
-   **当** 用户输入 "肿瘤侵犯胸壁，同侧纵隔淋巴结肿大"
-   **则** 系统识别 "侵犯胸壁" -> T3，"同侧纵隔淋巴结" -> N2。

### 需求 2：容错处理
系统应能处理模糊或缺失信息。
#### 场景：部分信息
-   **当** 用户只输入 "肿瘤大小 1.5cm"
-   **则** 系统选中 T1b，保持 N 和 M 为默认值 (Tx/Mx) 或提示用户补充。
